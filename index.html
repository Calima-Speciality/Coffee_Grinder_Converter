<!doctype html>
<html lang="de">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Grind Clicks Converter â€“ Calima Specialty Coffee</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React + ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <meta name="description" content="Convert coffee grinder clicks between different models using microns-per-click calibration. Made by Calima Specialty Coffee."/>
    <style>
      .flag-btn{padding:.4rem .55rem;border-radius:.75rem;border:1px solid #d4d4d8;background:#fff}
      .flag-btn.active{background:#111827;color:#fff;border-color:#111827}
      img.logo{height:56px;width:56px;object-fit:cover;border-radius:9999px}
    </style>
  </head>
  <body class="bg-[#fdf6ec] text-zinc-900"> <!-- light coffee cream background -->
    <div id="root"></div>

    <script type="text/babel" data-presets="env,react">
      const { useEffect, useMemo, useState } = React;

      // --- i18n ---
      const L = {
        de: { /* German */ 
          appTitle: "Mahl-Klicks-Konverter",
          manage: "MÃ¼hlen verwalten",
          converter: "Konverter",
          fromGrinder: "Von MÃ¼hle",
          toGrinder: "Zu MÃ¼hle",
          clicksOnSource: "Klicks an Quelle",
          estDelta: "GeschÃ¤tzte Partikel-Differenz",
          targetSetting: "Ziel-Einstellung",
          quickSpecs: "Kurz-Daten",
          from: "Von",
          to: "Zu",
          step: "Schritt",
          zero: "Null",
          addCustom: "+ Eigene MÃ¼hle hinzufÃ¼gen",
          notesTip:
            "Hinweis: Fertigungstoleranzen variieren. Als Ausgangspunkt nutzen und nach Geschmack/Flow feinjustieren. Eigene Null und Âµm/Klick kalibrieren.",
          footer:
            "FÃ¼r Kaffee-Enthusiasten und Profis. Kein Tracking. Daten bleiben in Ihrem Browser.",
          by: "Erstellt von Calima Specialty Coffee",
          collab: "MÃ¶chten Sie Informationen zu weiteren KaffeemÃ¼hlen beitragen, die wir auf unserer Website ergÃ¤nzen kÃ¶nnen? Bitte schreiben Sie an calima.speciality@gmail.com. Dies ist ein gemeinnÃ¼tziges Community-Projekt â€“ lassen Sie uns gemeinsam daran arbeiten!",
        },
        en: { /* English */ 
          appTitle: "Grind Clicks Converter",
          manage: "Manage grinders",
          converter: "Converter",
          fromGrinder: "From grinder",
          toGrinder: "To grinder",
          clicksOnSource: "Clicks on source",
          estDelta: "Estimated particle delta",
          targetSetting: "Target grinder setting",
          quickSpecs: "Quick specs",
          from: "From",
          to: "To",
          step: "Step",
          zero: "Zero",
          addCustom: "+ Add custom grinder",
          notesTip:
            "Heads-up: factory tolerances vary. Use this as a baseline, then dial-in by taste and flow. Calibrate your own zero and Âµm/click.",
          footer:
            "Built for coffee enthusiasts and professionals. No tracking. Data stays in your browser.",
          by: "Made by Calima Specialty Coffee",
          collab: "If you would like to share information about other coffee grinders to add to our website, please email calima.speciality@gmail.com. This is a community-driven charity project â€” letâ€™s collaborate to make it better!",
        },
        ru: { /* Russian */ 
          appTitle: "ÐšÐ¾Ð½Ð²ÐµÑ€Ñ‚ÐµÑ€ ÐºÐ»Ð¸ÐºÐ¾Ð² Ð¿Ð¾Ð¼Ð¾Ð»Ð°",
          manage: "Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ÐºÐ¾Ñ„ÐµÐ¼Ð¾Ð»ÐºÐ°Ð¼Ð¸",
          converter: "ÐšÐ¾Ð½Ð²ÐµÑ€Ñ‚ÐµÑ€",
          fromGrinder: "Ð˜ÑÑ…Ð¾Ð´Ð½Ð°Ñ ÐºÐ¾Ñ„ÐµÐ¼Ð¾Ð»ÐºÐ°",
          toGrinder: "Ð’Ð°ÑˆÐ° ÐºÐ¾Ñ„ÐµÐ¼Ð¾Ð»ÐºÐ°",
          clicksOnSource: "ÐšÐ»Ð¸ÐºÐ¸ Ð½Ð° Ð¸ÑÑ…Ð¾Ð´Ð½Ð¾Ð¹",
          estDelta: "ÐžÑ†ÐµÐ½ÐºÐ° Ñ€Ð°Ð·Ð½Ð¸Ñ†Ñ‹ Ñ‡Ð°ÑÑ‚Ð¸Ñ†",
          targetSetting: "ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð´Ð»Ñ Ð²Ð°Ð°ÑˆÐµÐ¹ ÐºÐ¾Ñ„ÐµÐ¼Ð¾Ð»ÐºÐ¸",
          quickSpecs: "ÐŸÐ°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹",
          from: "Ð˜Ð·",
          to: "Ð’",
          step: "Ð¨Ð°Ð³",
          zero: "ÐÐ¾Ð»ÑŒ",
          addCustom: "+ Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ ÑÐ²Ð¾ÑŽ ÐºÐ¾Ñ„ÐµÐ¼Ð¾Ð»ÐºÑƒ",
          notesTip:
            "Ð’Ð°Ð¶Ð½Ð¾: Ð·Ð°Ð²Ð¾Ð´ÑÐºÐ¸Ðµ Ð´Ð¾Ð¿ÑƒÑÐºÐ¸ Ñ€Ð°Ð·Ð»Ð¸Ñ‡Ð°ÑŽÑ‚ÑÑ. Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ ÐºÐ°Ðº ÑÑ‚Ð°Ñ€Ñ‚Ð¾Ð²ÑƒÑŽ Ñ‚Ð¾Ñ‡ÐºÑƒ Ð¸ Ð´Ð¾Ð²Ð¾Ð´Ð¸Ñ‚Ðµ Ð¿Ð¾ Ð²ÐºÑƒÑÑƒ/Ð¿Ð¾Ñ‚Ð¾ÐºÑƒ. ÐžÑ‚ÐºÐ°Ð»Ð¸Ð±Ñ€ÑƒÐ¹Ñ‚Ðµ ÑÐ²Ð¾Ð¹ Ð½Ð¾Ð»ÑŒ Ð¸ Âµm/ÐºÐ»Ð¸Ðº.",
          footer:
            "Ð”Ð»Ñ Ð»ÑŽÐ±Ð¸Ñ‚ÐµÐ»ÐµÐ¹ Ð¸ Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»Ð¾Ð² ÐºÐ¾Ñ„Ðµ. Ð‘ÐµÐ· Ñ‚Ñ€ÐµÐºÐ¸Ð½Ð³Ð°. Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð¾ÑÑ‚Ð°ÑŽÑ‚ÑÑ Ð² Ð²Ð°ÑˆÐµÐ¼ Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ðµ.",
          by: "Ð¡Ð´ÐµÐ»Ð°Ð½Ð¾ Calima Specialty Coffee",
          collab: "Ð•ÑÐ»Ð¸ Ð²Ñ‹ Ñ…Ð¾Ñ‚Ð¸Ñ‚Ðµ Ð¿Ð¾Ð´ÐµÐ»Ð¸Ñ‚ÑŒÑÑ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÐµÐ¹ Ð¾ Ð´Ñ€ÑƒÐ³Ð¸Ñ… ÐºÐ¾Ñ„ÐµÐ¼Ð¾Ð»ÐºÐ°Ñ…, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¼Ñ‹ Ð¼Ð¾Ð³Ð»Ð¸ Ð´Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð¸Ñ… Ð½Ð° Ð½Ð°Ñˆ ÑÐ°Ð¹Ñ‚, Ð½Ð°Ð¿Ð¸ÑˆÐ¸Ñ‚Ðµ Ð½Ð° calima.speciality@gmail.com. Ð­Ñ‚Ð¾ Ð±Ð»Ð°Ð³Ð¾Ñ‚Ð²Ð¾Ñ€Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ð¿Ñ€Ð¾ÐµÐºÑ‚ ÑÐ¾Ð¾Ð±Ñ‰ÐµÑÑ‚Ð²Ð° â€” Ð´Ð°Ð²Ð°Ð¹Ñ‚Ðµ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸Ñ‡Ð°Ñ‚ÑŒ!",
        },
      };

      // Defaults
      const DEFAULT_GRINDERS = [
        { id: "c40-standard",   name: "Comandante C40 (Standard)", stepMicron: 30,   zeroClick: 0, notes: "â‰ˆ30 Âµm/click" },
        { id: "c40-redclix",    name: "Comandante C40 (Red Clix)", stepMicron: 15,   zeroClick: 0, notes: "â‰ˆ15 Âµm/click" },
        { id: "1zpresso-jxpro", name: "1Zpresso JX-Pro",           stepMicron: 12.5, zeroClick: 0, notes: "â‰ˆ12â€“13 Âµm/click" },
        { id: "timemore-c2",    name: "Timemore Chestnut C2",      stepMicron: 36,   zeroClick: 0, notes: "â‰ˆ36 Âµm/click" },
        { id: "1zpresso-kplus", name: "1Zpresso K-Plus",           stepMicron: 22,   zeroClick: 0, notes: "â‰ˆ22 Âµm/click" },
        { id: "niche-zero",     name: "Niche Zero (dial number)",  stepMicron: 50,   zeroClick: 0, notes: "â‰ˆ50 Âµm/dial" },
      ];

      const STORAGE_KEY = "grinder-clicks-converter:v1";
      const LANG_KEY = "grinder-clicks-converter:lang";

      const uid = () => Math.random().toString(36).slice(2, 9);

      function loadGrinders() {
        try {
          const raw = localStorage.getItem(STORAGE_KEY);
          if (!raw) return DEFAULT_GRINDERS;
          const parsed = JSON.parse(raw);
          return Array.isArray(parsed) && parsed.length ? parsed : DEFAULT_GRINDERS;
        } catch { return DEFAULT_GRINDERS; }
      }
      const saveGrinders = (gs) => localStorage.setItem(STORAGE_KEY, JSON.stringify(gs));

      function App() {
        const [lang, setLang] = useState(localStorage.getItem(LANG_KEY) || "de");
        const t = L[lang] || L.de;

        const [grinders, setGrinders] = useState(loadGrinders);
        const [fromId, setFromId] = useState(grinders[0]?.id || "");
        const [toId, setToId] = useState(grinders[1]?.id || "");
        const [fromClicks, setFromClicks] = useState("18");

        useEffect(() => saveGrinders(grinders), [grinders]);

        const from = useMemo(() => grinders.find(g => g.id === fromId), [grinders, fromId]);
        const to   = useMemo(() => grinders.find(g => g.id === toId),   [grinders, toId]);

        const microns = useMemo(() => {
          const clicks = parseFloat(fromClicks);
          if (!from || Number.isNaN(clicks)) return null;
          return (clicks - from.zeroClick) * from.stepMicron;
        }, [from, fromClicks]);

        const toClicks = useMemo(() => {
          if (!to || microns == null) return null;
          return Math.floor(microns / to.stepMicron + to.zeroClick);
        }, [to, microns]);

        function addGrinder() {
          const g = { id: `custom-${uid()}`, name: "Custom grinder", stepMicron: 25, zeroClick: 0, notes: "" };
          setGrinders(prev => [...prev, g]);
          setToId(g.id);
        }

        return (
          <div className="min-h-screen">
            <div className="mx-auto max-w-5xl px-4 py-6 sm:py-8">
              {/* Header */}
              <header className="mb-6 flex items-center justify-between gap-3">
                <div className="flex items-center gap-3">
                  <img className="logo" src="./logo.jpg" alt="Calima Specialty Coffee logo" />
                  <div>
                    <h1 className="text-xl sm:text-2xl font-semibold">Calima Specialty Coffee</h1>
                    <div className="text-sm opacity-70">{t.appTitle}</div>
                  </div>
                </div>
                <div className="flex items-center gap-2">
                  <button className={`flag-btn ${lang==="de"?"active":""}`} onClick={() => {setLang("de"); localStorage.setItem(LANG_KEY,"de")}}>ðŸ‡©ðŸ‡ª</button>
                  <button className={`flag-btn ${lang==="en"?"active":""}`} onClick={() => {setLang("en"); localStorage.setItem(LANG_KEY,"en")}}>ðŸ‡¬ðŸ‡§</button>
                  <button className={`flag-btn ${lang==="ru"?"active":""}`} onClick={() => {setLang("ru"); localStorage.setItem(LANG_KEY,"ru")}}>ðŸ‡·ðŸ‡º</button>
                </div>
              </header>

              {/* Converter */}
              <section className="rounded-2xl bg-white p-5 shadow-sm ring-1 ring-zinc-200">
                <h2 className="mb-4 text-lg font-medium">{t.converter}</h2>
                <div className="grid gap-4 sm:grid-cols-2">
                  <div>
                    <label className="mb-1 block text-sm">{t.fromGrinder}</label>
                    <select className="w-full rounded-xl border border-zinc-300 bg-white p-2" value={fromId} onChange={e => setFromId(e.target.value)}>
                      {grinders.map(g => <option key={g.id} value={g.id}>{g.name}</option>)}
                    </select>
                  </div>
                  <div>
                    <label className="mb-1 block text-sm">{t.toGrinder}</label>
                    <select className="w-full rounded-xl border border-zinc-300 bg-white p-2" value={toId} onChange={e => setToId(e.target.value)}>
                      {grinders.map(g => <option key={g.id} value={g.id}>{g.name}</option>)}
                    </select>
                  </div>
                  <div>
                    <label className="mb-1 block text-sm">{t.clicksOnSource}</label>
                    <input inputMode="decimal" className="w-full rounded-xl border border-zinc-300 bg-white p-2" value={fromClicks} onChange={e => setFromClicks(e.target.value)} />
                  </div>
                </div>

                <div className="mt-6 grid gap-3">
                  <div className="rounded-xl bg-zinc-50 p-4 ring-1 ring-inset ring-zinc-200">
                    <p className="text-sm text-zinc-600">{t.estDelta}</p>
                    <p className="text-2xl font-semibold">{microns == null ? "â€”" : `${microns.toFixed(1)} Âµm`}</p>
                  </div>
                  <div className="rounded-xl bg-emerald-50 p-4 ring-1 ring-inset ring-emerald-200">
                    <p className="text-sm text-emerald-700">{t.targetSetting}</p>
                    <p className="text-3xl font-bold text-emerald-900">{toClicks == null ? "â€”" : `${toClicks} clicks`}</p>
                  </div>
                </div>

                <button onClick={addGrinder} className="mt-4 w-full rounded-xl bg-zinc-900 p-2 text-white hover:bg-zinc-800">
                  {t.addCustom}
                </button>
              </section>

<footer className="mt-10 text-center text-xs text-zinc-500">
  {t.footer}<br/><strong>{t.by}</strong><br/><br/>
  {t.collab}<br/><br/>
  <a href="https://instagram.com/calima_speciality" target="_blank" rel="noopener noreferrer" className="underline hover:text-zinc-700">
    Instagram: @calima_specialty
  </a>
</footer>

            </div>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>

